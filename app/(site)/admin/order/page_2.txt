"use client"

import React, { useState, useEffect } from "react"
// import Link from "next/link"
// import Image from "next/image"
import { Map } from '@vis.gl/react-maplibre';
import 'maplibre-gl/dist/maplibre-gl.css'; // See notes below

import { zodResolver } from "@hookform/resolvers/zod"
import { useForm } from "react-hook-form"
import { z } from "zod"

import { Button } from "@/components/ui/button"
// import {
//   Form,
//   FormControl,
//   FormDescription,
//   FormField,
//   FormItem,
//   FormLabel,
//   FormMessage,
// } from "@/components/ui/form"
import { Input } from "@/components/ui/input"

// import { Checkbox } from "@/components/ui/checkbox"
// import { SignIn } from "@phosphor-icons/react/dist/ssr"

import {
  Card,
  CardContent,
  // CardDescription,
  CardFooter,
  CardHeader,
  CardTitle,
} from "@/components/ui/card"
// import { NumberInput } from "@/components/ui/input-number"
import { Label } from "@/components/ui/label"
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle,
  DialogTrigger,
} from "@/components/ui/dialog"
// import {
//   Select,
//   SelectContent,
//   SelectItem,
//   SelectTrigger,
//   SelectValue,
// } from "@/components/ui/select"

import {
  Box,
  Flex,
  Text,
  RadioCards
} from "@radix-ui/themes";

// import { getBuyOrders } from "@/lib/db/queries"

const formSchema = z.object({
  username: z.string().min(2, {
    message: "Username must be at least 2 characters.",
  }),
})

export default function Analytics() {
  // const orders = await getBuyOrders();
  const [orders, setOrders] = useState([{ id: "1", price: 87000 }, { id: "2", price: 90000 }, { id: "3", price: 92000 }])

  // useEffect(() => {
  //   async function fetchOrders() {
  //     // const res = await fetch('https://api.vercel.app/blog')
  //     const orders = await getBuyOrders();
  //     // const data = await res.json()
  //     setOrders(orders)
  //   }
  //   fetchOrders()
  // }, [])

  const form = useForm<z.infer<typeof formSchema>>({
    resolver: zodResolver(formSchema),
    defaultValues: {
      username: "",
    },
  })

  // 2. Define a submit handler.
  function onSubmit(values: z.infer<typeof formSchema>) {
    // Do something with the form values.
    // ✅ This will be type-safe and validated.
    console.log(values)
  }

  return (
    <div>
      {/* <Form {...form}>
        <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-8">
          <FormField
            control={form.control}
            name="username"
            render={({ field }) => (
              <FormItem>
                <FormLabel>Username</FormLabel>
                <FormControl>
                  <Input placeholder="shadcn" {...field} />
                </FormControl>
                <FormDescription>
                  This is your public display name.
                </FormDescription>
                <FormMessage />
              </FormItem>
            )}
          />
          <Button type="submit">Submit</Button>
        </form>
      </Form> */}
      <Card className="max-w-[600px] mx-auto my-4">
        <CardHeader>
          <CardTitle style={{ color: "green" }}>سفارش خرید</CardTitle>
          {/* <CardDescription>با انتخاب آدرس دقیق، قیمت تمام شده دقیق محاسبه می گردد.</CardDescription> */}
        </CardHeader>
        <CardContent>
          <form>
            <div className="grid w-full items-center gap-2 mt-4">
              <div className="flex flex-col space-y-1.5">
                <Label htmlFor="name" className="text-md font-bold">آدرس تحویل کالا:</Label>
                <Dialog>
                  <DialogTrigger asChild>
                    <Button variant="outline">شیراز، پاسارگاد شمالی...</Button>
                  </DialogTrigger>
                  <DialogContent className="sm:max-w-[425px]">
                    <DialogHeader>
                      <DialogTitle>آدرس های منتخب</DialogTitle>
                      <DialogDescription>
                        لیست آدرس های منتخب شما
                      </DialogDescription>
                    </DialogHeader>
                    <div className="grid gap-4 py-4">
                      {/* <div className="grid grid-cols-4 items-center gap-4"> */}
                      <div className="grid items-center">
                        {/* <Label htmlFor="one" className="text-right">
                          Name
                        </Label> */}
                        <Input
                          id="one"
                          defaultValue="شیراز، پاسارگاد شمالی"
                        // className="col-span-3"
                        />
                      </div>
                      {/* <div className="grid grid-cols-4 items-center gap-4"> */}
                      <div className="grid items-center">
                        {/* <Label htmlFor="two" className="text-right">
                          Username
                        </Label> */}
                        <Input
                          id="two"
                          defaultValue="بوشهر، میدان نخلستان"
                        // className="col-span-3"
                        />
                      </div>
                    </div>
                    <Map
                      initialViewState={{
                        longitude: 51.33,
                        latitude: 35.72,
                        zoom: 3.5
                      }}
                      style={{ width: "100%", height: 200 }}
                      mapStyle="https://demotiles.maplibre.org/style.json"
                    />
                    <DialogFooter>
                      <Button type="submit">انتخاب آدرس</Button>
                    </DialogFooter>
                  </DialogContent>
                </Dialog>
              </div>
              <Text size="4" weight="bold" className="mt-8">
                کالا:
              </Text>
              <Box>
                {/* <RadioCards.Root defaultValue="1" columns={{ initial: "1", sm: "2" }} dir="rtl"> */}
                <RadioCards.Root defaultValue="1" columns="2" dir="rtl" color="green">
                  <RadioCards.Item value="1">
                    <Flex direction="column" width="100%">
                      <Text weight="bold">سیمان</Text>
                      <Text>کیسه/ یا تناژ</Text>
                    </Flex>
                  </RadioCards.Item>
                  <RadioCards.Item value="2" disabled>
                    <Flex direction="column" width="100%">
                      <Text weight="bold">پودر سنگ</Text>
                      <Text>کیسه/ یا تناژ</Text>
                    </Flex>
                  </RadioCards.Item>
                  <RadioCards.Item value="3" disabled>
                    <Flex direction="column" width="100%">
                      <Text weight="bold">ماسه</Text>
                      <Text>یک کامیون/ یا تناژ</Text>
                    </Flex>
                  </RadioCards.Item>
                  <RadioCards.Item value="4" disabled>
                    <Flex direction="column" width="100%">
                      <Text weight="bold">آجر</Text>
                      <Text>یک کامیون/ یا تناژ</Text>
                    </Flex>
                  </RadioCards.Item>
                  <RadioCards.Item value="5" disabled>
                    <Flex direction="column" width="100%">
                      <Text weight="bold">آب</Text>
                      <Text>تانکر</Text>
                    </Flex>
                  </RadioCards.Item>
                </RadioCards.Root>
              </Box>
              <Text size="4" weight="bold" className="mt-8">
                واحد:
              </Text>
              <Box>
                {/* <RadioCards.Root defaultValue="1" columns={{ initial: "1", sm: "2" }} dir="rtl"> */}
                <RadioCards.Root defaultValue="1" columns="2" dir="rtl" color="green">
                  <RadioCards.Item value="1">
                    <Flex direction="column" width="100%">
                      <Text weight="bold">کیسه</Text>
                      <Text>توضیحات بیشتر</Text>
                    </Flex>
                  </RadioCards.Item>
                  <RadioCards.Item value="2" disabled>
                    <Flex direction="column" width="100%">
                      <Text weight="bold">تناژ</Text>
                      <Text>توضیحات بیشتر</Text>
                    </Flex>
                  </RadioCards.Item>
                </RadioCards.Root>
              </Box>
              <Text size="4" weight="bold" className="mt-8">
                حجم سفارش به کیسه:
              </Text>
              <Box>
                {/* <RadioCards.Root defaultValue="1" columns={{ initial: "1", sm: "2" }} dir="rtl"> */}
                <RadioCards.Root defaultValue="5" columns="2" dir="rtl" color="green">
                  <RadioCards.Item value="5">
                    <Flex direction="column" width="100%">
                      <Text weight="bold">۵</Text>
                      {/* <Text>توضیحات بیشتر</Text> */}
                    </Flex>
                  </RadioCards.Item>
                  <RadioCards.Item value="10">
                    <Flex direction="column" width="100%">
                      <Text weight="bold">۱۰</Text>
                      {/* <Text>توضیحات بیشتر</Text> */}
                    </Flex>
                  </RadioCards.Item>
                  <RadioCards.Item value="20">
                    <Flex direction="column" width="100%">
                      <Text weight="bold">۲۰</Text>
                      {/* <Text>توضیحات بیشتر</Text> */}
                    </Flex>
                  </RadioCards.Item>
                  <RadioCards.Item value="30">
                    <Flex direction="column" width="100%">
                      <Text weight="bold">۳۰</Text>
                      {/* <Text>توضیحات بیشتر</Text> */}
                    </Flex>
                  </RadioCards.Item>
                  <RadioCards.Item value="40">
                    <Flex direction="column" width="100%">
                      <Text weight="bold">۴۰</Text>
                      {/* <Text>توضیحات بیشتر</Text> */}
                    </Flex>
                  </RadioCards.Item>
                  <RadioCards.Item value="100" disabled>
                    <Flex direction="column" width="100%">
                      <Text weight="bold">حجم دلخواه</Text>
                      {/* <Text>توضیحات بیشتر</Text> */}
                    </Flex>
                  </RadioCards.Item>
                </RadioCards.Root>
              </Box>
              {/* <Input name="price" defaultValue="0" /> */}
              {/* <NumberInput title="کیسه" /> */}
            </div>
          </form>
          {/* <div className="flex justify-center items-center min-h-12 border border-dashed text-muted-foreground p-2 mt-8">
            برای مشاهده بازار فروش در بالا مشخص کنید که چه کالایی را با چه حجمی می‌خواهید. دقت کنید که جستجوی بازار بر اساس آدرس تحویل کالا انجام می‌شود.
          </div> */}
          <div className="mt-8">
            <Text size="4" weight="bold" color="red">
              بازار فروش:
            </Text>
            <RadioCards.Root defaultValue={orders[0].id} color="green" columns={{ initial: "1", sm: "1" }} dir="rtl" className="mt-4">
              {orders.map((order) => (
                <RadioCards.Item key={order.id} value={order.id}>
                  <Flex direction="column" width="100%">
                    <Text weight="bold">سیمان فارس - {order.price} تومان</Text>
                    <Text>فروشگاه مصالح عباس پور</Text>
                  </Flex>
                </RadioCards.Item>)
              )}
            </RadioCards.Root>
          </div>
        </CardContent>
        <CardFooter className="flex justify-between">
          {/* <Button variant="outline">لغو سفارش</Button> */}
          <div />
          <Button style={{ backgroundColor: "green" }} disabled>سفارش خرید</Button>
        </CardFooter>
      </Card>
    </div>
  )
}
